class Bibliotheque:#c'est la classe principale ou toutes les information sur les livres et les utilisateur sont utiliiser

    def __init__(self):
        self.__livres = []  # Attribut privé
        self.__utilisateurs = {}  # Attribut privé

    #Les getters
    @property
    def livres(self):
        return self.__livres.copy()

    @property
    def utilisateurs(self):
        return self.__utilisateurs.copy()

    #Méthodes internes
    def _ajouter_livre_interne(self, livre):
        self.__livres.append(livre)#ajouter les information du livre dans la liste

    def _modifier_livre_interne(self, id_livre, nouveau_titre=None, nouvel_auteur=None,
                                nouvelle_categorie=None, nouveau_statut=None):
        for livre in self.__livres:
            if livre.ID == id_livre:
                if nouveau_titre:#on cherche si l'information a changer est le titre,l'auteur,la catégorie ou le satut
                    livre.titre = nouveau_titre
                if nouvel_auteur:
                    livre.auteur = nouvel_auteur
                if nouvelle_categorie:
                    livre.categorie = nouvelle_categorie
                if nouveau_statut is not None:
                    livre.statut = nouveau_statut
                return True
        print(f"Livre ID {id_livre} non trouvé")
        return False

    def _supprimer_livre_interne(self, id_livre):
        for livre in self.__livres:
            if livre.ID == id_livre:
                self.__livres.remove(livre)#enlever le livre de la liste
                return True
        print(f"Livre ID {id_livre} non trouvé")#mettre une condition si il ne se passe rien alors le livre n'as pas été trouvé
        return False

    #Méthodes publiques
    def afficher(self):
        if not self.__livres:
            print("La bibliothèque est vide")
            return

        for livre in self.__livres:
            print(livre)

    def recherche(self, mot):
        resultats = []

        for livre in self.__livres:
            if mot.lower() in livre.statut.lower() or mot.lower() in livre.titre.lower() or mot.lower() in livre.auteur.lower() or mot.lower() in livre.categorie.lower():#rechercher si le mot en les comparant avec tous les titres, les auteurs , les catégories ou les statuts de la liste
                resultats.append(livre)

        if resultats:
            for livre in resultats:
                print(livre)
        else:
            print("Aucun résultat trouvé")

        return resultats

    #fonction sur les utilisateurs
    def ajouter_utilisateur(self, utilisateur):
        self.__utilisateurs[utilisateur.id] = utilisateur#ajouter l'utilisateur dans le dictionnaire
        print(f"Utilisateur '{utilisateur.nom_complet}' ajouté (ID: {utilisateur.id})")

    def supprimer_utilisateur(self, id_utilisateur):
        if id_utilisateur in self.__utilisateurs:
            user = self.__utilisateurs.pop(id_utilisateur)#supprimer l'utilisateur dans le dictionnaire
            print(f"Utilisateur '{user.nom_complet}' supprimé")
        else:
            print(f"Utilisateur ID {id_utilisateur} non trouvé")

    def modifier_utilisateur(self, id_utilisateur, nouveau_nom=None, nouvel_email=None):
        if id_utilisateur in self.__utilisateurs:
            user = self.__utilisateurs[id_utilisateur]
            if nouveau_nom:
                user.nom_complet = nouveau_nom  # Utilise le setter
            if nouvel_email:
                user.email = nouvel_email  # Utilise le setter
            print(f"Utilisateur ID {id_utilisateur} modifié")
        else:
            print(f"Utilisateur ID {id_utilisateur} non trouvé")

    def afficher_utilisateurs(self):
        if not self.__utilisateurs:
            print("Aucun utilisateur enregistré")
            return

        for user in self.__utilisateurs.values():#créer une boucle pour afficher chaque index de la liste
            print(user)

    def rechercher_utilisateur(self, id_utilisateur):
        return self.__utilisateurs.get(id_utilisateur)
