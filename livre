class Livre:
    compteur_id = 1  # Compteur pour ID auto-incrémenté

    def __init__(self, titre, auteur, categorie, nbr_exemplaire_disp, statut=False):
        self.__id = Livre.compteur_id  # Attribut privé
        Livre.compteur_id += 1
        self.__titre = titre  # Attribut privé
        self.__auteur = auteur  # Attribut privé
        self.__categorie = categorie  # Attribut privé
        self.__nbr_exemplaire_disp = nbr_exemplaire_disp  # Attribut privé
        self.__statut = statut  # Attribut privé (disponible/emprunté)

    @property
    def ID(self):
        return self.__id

    @property
    def titre(self):
        return self.__titre

    @property
    def auteur(self):
        return self.__auteur

    @property
    def categorie(self):
        return self.__categorie

    @property
    def nbr_exemplaire_disp(self):
        return self.__nbr_exemplaire_disp

    @property
    def statut(self):
        return self.__statut

    # === SETTERS (modification avec validation) ===
    @titre.setter
    def titre(self, nouveau_titre):
        if len(nouveau_titre) >= 1:
            self.__titre = nouveau_titre
        else:
            print("Le titre ne peut pas être vide")

    @auteur.setter
    def auteur(self, nouvel_auteur):
        if len(nouvel_auteur) >= 2:
            self.__auteur = nouvel_auteur
        else:
            print("Le nom de l'auteur doit contenir au moins 2 caractères")

    @categorie.setter
    def categorie(self, nouvelle_categorie):
        categories_valides = ["roman", "science", "informatique", "fantasy",
                              "dystopie", "action", "histoire", "biographie"]
        if nouvelle_categorie.lower() in categories_valides:
            self.__categorie = nouvelle_categorie
        else:
            print(f"Catégorie invalide. Catégories valides : {', '.join(categories_valides)}")

    @nbr_exemplaire_disp.setter
    def nbr_exemplaire_disp(self, nouveau_nombre):
        """Modifie le nombre d'exemplaires avec validation"""
        if nouveau_nombre >= 0:
            self.__nbr_exemplaire_disp = nouveau_nombre
            # Mise à jour automatique du statut
            self.__statut = (nouveau_nombre == 0)
        else:
            print("Le nombre d'exemplaires ne peut pas être négatif")

    @statut.setter
    def statut(self, nouveau_statut):
        self.__statut = nouveau_statut

    # === MÉTHODES PUBLIQUES ===
    def est_disponible(self):
        return self.__nbr_exemplaire_disp > 0

    def __str__(self):
        statut_txt = "Emprunté" if self.__statut else "Disponible"
        return (f"ID: {self.__id}, Titre: {self.__titre}, Auteur: {self.__auteur}, "
                f"Catégorie: {self.__categorie}, Dispo: {self.__nbr_exemplaire_disp}, "
                f"Statut: {statut_txt}")

    def __repr__(self):
        return f"Livre(ID={self.__id}, titre='{self.__titre}')"
